2026-02-22 â€” Discord signature verification middleware

Summary:
- Added Ed25519 Discord interaction signature verification middleware at: skills/discord/verify_signature_middleware.js
- Purpose: verify X-Signature-Ed25519 + X-Signature-Timestamp per Discord docs before processing interactions.

Integration notes:
- Required env: DISCORD_PUBLIC_KEY (hex)
- Req: use a raw-body parser that preserves the request raw bytes (see example). The middleware expects req.rawBody.
- Remove long-lived bot tokens from openclaw.json and store in a secret manager / env var instead.

Express integration (example):

```javascript
// javascript
import express from 'express';
import bodyParser from 'body-parser';
import { discordSignatureMiddleware } from './skills/discord/verify_signature_middleware.js';

const app = express();
// capture raw body for signature verification
app.use(bodyParser.json({ verify: (req, res, buf) => { req.rawBody = buf; } }));

// protect interaction endpoint
app.post('/discord/interactions', discordSignatureMiddleware, (req, res) => {
  // handle verified interaction
  res.json({ type: 1 });
});

app.listen(3000);
```

Next actions recommended:
- Rotate Discord bot token and remove it from workspace configs.
- Add signature verification to all Discord webhook/interaction endpoints.
- Add audit logging for channel-create/delete operations.

Saved-by: OpenClawA_rm
